<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Customer Admin</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

<!-- REQUIRED FOR YOUR VALIDATION -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/jquery.validation/1.19.5/jquery.validate.min.js"></script>

<style>
:root {
--sidebar-width:170px;
--sidebar-collapsed-width:75px;
--layout-gap:16px;
}

body { background:#f8f9fa; overflow-x:hidden; }

.sidebar{
width:var(--sidebar-width);
height:100vh;
position:fixed;
left:0;
top:0;
background:#fff;
border-right:1px solid #dee2e6;
padding:20px 12px;
transition:.25s;
z-index:1000;
}

.sidebar.collapsed{ width:var(--sidebar-collapsed-width); }
.sidebar.collapsed .link-text,
.sidebar.collapsed h4{ display:none; }

.sidebar .nav-link{
padding:12px 15px;
border-radius:8px;
display:flex;
gap:10px;
color:#495057;
text-decoration:none;
}

.sidebar .nav-link.active{
background:#0d6efd;
color:#fff;
}

.navbar{
margin-left:calc(var(--sidebar-width) + var(--layout-gap));
background:#fff;
border-bottom:1px solid #dee2e6;
}

.content{
margin-left:calc(var(--sidebar-width) + var(--layout-gap));
padding:20px;
}

.collapsed-margin{
margin-left:calc(var(--sidebar-collapsed-width) + var(--layout-gap))!important;
}

@media(max-width:991px){
.navbar,.content{ margin-left:0!important; }
.sidebar{ left:-100%; }
.sidebar.mobile-show{ left:0; }
}

/* DARK */

body.dark-mode{ background:#121212; color:#e0e0e0; }
.dark-mode .sidebar,
.dark-mode .navbar,
.dark-mode .card{ background:#1a1a1a; color:#eee; }

label.error{
color:#dc3545;
font-size:.9rem;
margin-top:4px;
}
</style>
</head>

<body>

<!-- SIDEBAR -->
<div class="sidebar" id="sidebar">
<h4 class="px-3 mb-4 text-primary">Admin</h4>
<a href="home.html" class="nav-link"><i class="bi bi-house"></i><span class="link-text">Home</span></a>
<a href="customer.html" class="nav-link active"><i class="bi bi-people"></i><span class="link-text">Customers</span></a>
</div>

<!-- NAVBAR -->
<nav class="navbar sticky-top px-3 py-2 shadow-sm" id="navbar">
<div class="container-fluid">

<button class="btn btn-light border" id="toggle-btn">
<i class="bi bi-list"></i>
</button>

<button class="btn btn-light border ms-auto" id="darkBtn">
<i class="bi bi-moon-stars"></i>
</button>

</div>
</nav>

<!-- CONTENT -->
<div class="content">
<div class="container-fluid">

<div class="card shadow-sm p-4">
<div class="d-flex justify-content-between mb-3">
<h3>Customer List</h3>
<button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#customerModal" onclick="resetForm()">Add</button>
</div>

<table id="customerTable" class="table table-hover">
<thead>
<tr>
<th>ID</th><th>Name</th><th>Role</th><th>Email</th><th>City</th><th>Phone</th><th>Action</th>
</tr>
</thead>
<tbody></tbody>
</table>

</div>
</div>
</div>

<!-- MODAL -->
<div class="modal fade" id="customerModal">
<div class="modal-dialog">
<div class="modal-content">

<div class="modal-header bg-primary text-white">
<h5 id="modalTitle">Add Customer</h5>
<button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
</div>

<form id="custForm">
<div class="modal-body">

<input type="hidden" id="editRowIndex">

<input class="form-control mb-3" id="customerName" name="customerName" placeholder="Name">

<div class="mb-3">
<label><input type="radio" name="customerRole" value="Admin"> Admin</label>
<label class="ms-3"><input type="radio" name="customerRole" value="User" checked> User</label>
</div>

<input class="form-control mb-3" id="customerEmail" name="customerEmail" placeholder="Email">
<input class="form-control mb-3" id="customerCity" name="customerCity" placeholder="City">
<input class="form-control" id="customerNumber" name="customerNumber" placeholder="Phone">

</div>

<div class="modal-footer">
<button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
<button class="btn btn-primary" type="submit">Save</button>
</div>

</form>

</div>
</div>
</div>

<!-- BOOTSTRAP JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function(){

/* SIDEBAR */
const sidebar=document.getElementById("sidebar");
const navbar=document.getElementById("navbar");
const content=document.querySelector(".content");

toggleBtn.onclick=()=>{
if(window.innerWidth<992){ sidebar.classList.toggle("mobile-show"); return; }
sidebar.classList.toggle("collapsed");
navbar.classList.toggle("collapsed-margin");
content.classList.toggle("collapsed-margin");
};

/* DARK */
darkBtn.onclick=()=>{
document.body.classList.toggle("dark-mode");
localStorage.setItem("theme",document.body.classList.contains("dark-mode")?"dark":"light");
};

if(localStorage.getItem("theme")==="dark"){
document.body.classList.add("dark-mode");
}

/* VALIDATION */
$("#custForm").validate({
rules:{
customerName:{required:true,minlength:3},
customerEmail:{required:true,email:true},
customerCity:{required:true},
customerNumber:{required:true,digits:true,minlength:10,maxlength:10}
},
submitHandler:function(){
saveRow();
}
});

});

/* CRUD */

function saveRow(){
const name=customerName.value;
const role=$('input[name="customerRole"]:checked').val();
const email=customerEmail.value;
const city=customerCity.value;
const phone=customerNumber.value;
const idx=editRowIndex.value;
const tbody=document.querySelector("#customerTable tbody");

if(idx===""){
const row=tbody.insertRow();
row.innerHTML=buildRow(tbody.rows.length+1,name,role,email,city,phone);
}else{
const row=tbody.rows[idx];
row.innerHTML=buildRow(idx+1,name,role,email,city,phone);
}

bootstrap.Modal.getInstance(customerModal).hide();
resetForm();
}

function buildRow(id,n,r,e,c,p){
return `<td>${id}</td>
<td>${n}</td>
<td><span class="badge ${r==="Admin"?"bg-primary":"bg-secondary"}">${r}</span></td>
<td>${e}</td>
<td>${c}</td>
<td>${p}</td>
<td>
<button class="btn btn-sm btn-info" onclick="editRow(this)">‚úè</button>
<button class="btn btn-sm btn-danger" onclick="deleteRow(this)">üóë</button>
</td>`;
}

function editRow(btn){
const row=btn.closest("tr");
editRowIndex.value=row.rowIndex-1;
modalTitle.innerText="Edit Customer";
customerName.value=row.cells[1].innerText;
$('input[name="customerRole"][value="'+row.cells[2].innerText+'"]').prop("checked",true);
customerEmail.value=row.cells[3].innerText;
customerCity.value=row.cells[4].innerText;
customerNumber.value=row.cells[5].innerText;
new bootstrap.Modal(customerModal).show();
}

function deleteRow(btn){
btn.closest("tr").remove();
renumber();
}

function renumber(){
$("#customerTable tbody tr").each(function(i){
this.cells[0].innerText=i+1;
});
}

function resetForm(){
custForm.reset();
editRowIndex.value="";
modalTitle.innerText="Add Customer";
$(".is-valid,.is-invalid").removeClass("is-valid is-invalid");
}
</script>

</body>
</html>
